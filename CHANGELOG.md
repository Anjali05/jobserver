# Changelog

## 0.9.0

- Renamed `job matrix stat` to `job matrix ls` for better consistency with `job ls`.
- The following have all been removed in favor of the new `job stat` command:
    - The `--output` flags of `job matrix ls` and `job ls`
    - The `job matrix csv` subcommand
    - The `job results` subcommand
- The `job stat` command has gained significant super powers. It is now vastly
  more useful for post-processing results, and outputing data into a number of
  useful formats. See the help message for more info, but here are some
  examples:
    - Print a plain text table of the given experiments with only the given columns:
      ```sh
      > j job stat --text --jid --time --machine $EXPERIMENT_JIDS
      JID   TIME    MACHINE
      14923 1h34m   clnode199.clemson.cloudlab.us:22
      14951 1h4m    clnode201.clemson.cloudlab.us:22
      14956
      14963 46m2s   clnode212.clemson.cloudlab.us:22
      ```
    - Print a JSON of all information about the given jobs:
      ```sh
      > j job stat --json --all $EXPERIMENT_JIDS
      TODO
      ```
    - Print a CSV generated by mapping each job's info with the given scipt,
      which takes a JSON of all info about a job:
      ```sh
      > j job stat --csv --all --map /path/to/script.py
      TODO
      ```
    - Print a plain text table of the given experiments, using the given script
      to map over a particular column of the data as plain text:
      ```sh
      > j job stat --text --jid --output --map-output /path/to/script.sh $EXPERIMENT_JIDS
      ```
    - Combine with shell to restart all failed jobs among the listed experiments:
      ```sh
      > j job restart $(j job stat --text --jid --status $EXPERIMENT_JIDS | grep Failed | awk '{print $1}')
      ```

## 0.8.1

- Fixes a panic on "narrow" terminals.

## 0.8.0

- Change the way results files are identified. The runner should now return a
  common prefix of all files to be copied, and the jobserver will copy all
  files with that prefix. In contrast, in the past, you had to return a
  filepath with a glob.
- The client now has some better support for manipulating said prefixes.

## 0.7.1

- Added `machine mv` subcommand.
- Fix minor bugs.

## 0.7.0

- Matrices that have become empty because all of their jobs were forgotten will
  also be forgotten. This is different from prior behavior, so I'm bumping the
  major version.
- Added support for timing out jobs.
- Added a shortcut for restarting a job.
- Added `-r` flag to list all running jobs.
- Fix some bugs.
- Bump the optimization level a bit.

## 0.6.1

- Minor backwards-compatible changes to client-server protocol and vast
  refactoring of client-side printing for `job ls`. These produce a major
  improvement in the format of job listings for matrices.

## 0.6

- Changes to client-side `j machine rm` arguments to allow removing classes of
  machines more easily. This allows removing expired reservations more easily.

## 0.5

- Add `j job results` subcommand.
- Major improvements to handling of failed/cloned jobs in matrices:
    - When a matrix job is cloned, the clone also ends up in the matrix.
    - Matrix jobs automatically repeat on failure.
- `j job matrix add` now supports the `-x` flag.
- `j job ls` now prints a summary of the printed jobs.
- Internal rearchitecting of the thread that copies results back to the host.
  This may allow future improvements to handling of failed/timed out/hanging
  copying tasks.

## 0.4

- Reimplemented the server state serialization for snapshots. This fixes weird
  errors where tasks would become corrutped after a server restart for no
  apparent reason. Unfortunately, this is breaking change to the format of the
  server snapshots, so tasks that were already in the snapshot will show as
  `Unknown` after restarting the server into version 0.4.

## 0.3

- This is the first version I published on crates.io.
